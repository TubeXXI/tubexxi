syntax = "proto3";

package scraper;
option go_package = "tubexxi/video-api/proto";

service ScraperService {
  rpc ScrapeHome (Empty) returns (HomeResponse);
  rpc ScrapeList (ListRequest) returns (ListResponse);
  
  // New RPCs
  rpc GetMoviesByGenre (GenreRequest) returns (ListResponse);
  rpc SearchMovies (SearchRequest) returns (ListResponse);
  rpc GetMoviesByFeature (FeatureRequest) returns (ListResponse);
  rpc GetMoviesByCountry (CountryRequest) returns (ListResponse);
  rpc GetMoviesByYear (YearRequest) returns (ListResponse);
  rpc GetSpecialPage (SpecialPageRequest) returns (ListResponse);

  // Detail
  rpc GetMovieDetail (MovieDetailRequest) returns (MovieDetailResponse);

  // Series RPCs
  rpc GetSeriesHome (Empty) returns (HomeResponse);
  rpc GetSeriesByGenre (GenreRequest) returns (ListResponse);
  rpc SearchSeries (SearchRequest) returns (ListResponse);
  rpc GetSeriesByFeature (FeatureRequest) returns (ListResponse);
  rpc GetSeriesByCountry (CountryRequest) returns (ListResponse);
  rpc GetSeriesByYear (YearRequest) returns (ListResponse);
  rpc GetSeriesSpecialPage (SpecialPageRequest) returns (ListResponse);
}


message Empty {}

message ListRequest {
  string url = 1;
}

message GenreRequest {
  string slug = 1;
  int32 page = 2;
}

message SearchRequest {
  string query = 1;
  int32 page = 2;
}

message FeatureRequest {
  // populer, most-commented, rating, release, latest
  string feature_type = 1; 
  int32 page = 2;
}

message CountryRequest {
  string country_slug = 1;
  int32 page = 2;
}

message YearRequest {
  int32 year = 1;
  int32 page = 2;
}

message SpecialPageRequest {
  string page_name = 1;
  int32 page = 2;
}

message MovieDetailRequest {
  string slug = 1;
}


message Movie {
  string id = 1;
  string title = 2;
  optional string original_title = 3;
  optional string thumbnail = 4;
  optional string synopsis = 5;
  optional float rating = 6;
  optional int64 duration = 7;
  optional int32 year = 8;
  optional string date_published = 9;
  optional string label_quality = 10;
  optional string genre = 11;
  optional string original_page_url = 12;
}

message HomeSection {
  string key = 1;
  repeated Movie value = 2;
  optional string view_all_url = 3;
}

message HomeResponse {
  repeated HomeSection sections = 1;
}

message Pagination {
  int32 current_page = 1;
  int32 total_page = 2;
  bool has_next = 3;
  bool has_prev = 4;
  optional string next_page_url = 5;
  optional string prev_page_url = 6;
}

message ListResponse {
  repeated Movie movies = 1;
  Pagination pagination = 2;
}

message PlayerUrl {
  string url = 1;
  string type = 2;
}

message MoviePerson {
  string name = 1;
  string page_url = 2;
}

message CountryMovie {
  string name = 1;
  string page_url = 2;
}

message Genre {
  string name = 1;
  string page_url = 2;
}

message MovieDetail {
  Movie movie = 1;
  int64 votes = 2;
  string release_date = 3;
  string updated_at = 4;
  repeated PlayerUrl player_urls = 5;
  string trailer_url = 6;
  repeated MoviePerson directors = 7;
  repeated MoviePerson movie_stars = 8;
  repeated CountryMovie countries = 9;
  repeated Genre genres = 10;
  repeated Movie similar_movies = 11;
}

message MovieDetailResponse {
  MovieDetail detail = 1;
}
